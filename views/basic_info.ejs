<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Begin!!</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
    </script>
    <link rel="stylesheet" href="/css/basicpage.css">
</head>

<body>
    <div>
        <div id="leftPanel" class="leftpanel">
            <a href="/drop_columns" role="button">Drop Columns </a>
            <br>
            <a href="/drop_rows" role="button">Drop rows with nan values </a>
            <br>
            <a href="/plot_graph" role="button">Plot Graph</a>
            <br>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#categorical_labelling">
                Categorical Labelling
            </button>
            <br>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#correlation_matrix">
                Correlation Matrix
            </button>
            <br>
            <a href="/data_transform" role="button">Data Tranformation</a>
            <br>
            <a href="/pca" role="button">Principal Component Analysis</a>
            <br>
            <a href="/fill_nan" role="button">Fill nan values </a>
            <br>
            <a href="/remove_outlier" role="button">Remove outlier</a>
        </div>

        <div class="main">
            <% if (list.columns == "empty"){ %>
            <h2>Dataframe seems to be empty</h2>
            <% } else{%>
            <h3>shape :</h3>
            <%=list.shape%>
            <br>
            <br>
            <br>
            <br>
            <h3>general info</h3>
            <table style="width: 100%;">
                <tr>
                    <th>columns</th>
                    <% list.columns.forEach(function(col) { %>
                    <th><%= col %></th>
                    <% });  %>
                </tr>
                <tr>
                    <th>dtype</th>
                    <% list.dtype.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>count</th>
                    <% list.count.forEach(function (ct) { %>
                    <td><%= ct %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>Null values</th>
                    <% list.null_val.forEach(function (nu) { %>
                    <td><%= nu %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>Null percent</th>
                    <% list.null_val.forEach(function (nu,i) { %>
                    <td><%= (nu/(nu+list.count[i]))*100 %> </td>
                    <% }); %>
                </tr>
            </table>
            <br>
            <br>
            <br>
            <h3>Numerical data statistical description</h3>

            <% if (list.numerical == "empty"){ %>
            <h6>Numerical Dataframe seems to be empty</h6>
            <% } else{%>

            <table style="width: 80%;">
                <tr>
                    <th>columns</th>
                    <% list.numerical.forEach(function(col) { %>
                    <th><%= col %></th>
                    <% });  %>
                </tr>
                <tr>
                    <th>mean</th>
                    <% list.mean.forEach(function (mn) { %>
                    <td><%= mn %></td>
                    <% }); %>
                </tr>
                <tr>
                    <th>median</th>
                    <% list.median.forEach(function (md) { %>
                    <td><%= md %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>min</th>
                    <% list.minimum.forEach(function (mn) { %>
                    <td><%= mn %></td>
                    <% }); %>
                </tr>
                <tr>
                    <th>max</th>
                    <% list.maximum.forEach(function (mx) { %>
                    <td><%= mx %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>standard deviation</th>
                    <% list.std.forEach(function (st) { %>
                    <td><%= st %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>25%</th>
                    <% list.quant25.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>50%</th>
                    <% list.quant50.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>75%</th>
                    <% list.quant75.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
            </table>
            <%}%>
                <br>
                <br>
                <br>
                <h3>categorical data statistical description</h3>
                <% if (list.categorical == "empty"){ %>
            <h6>Categorical Dataframe seems to be empty</h6>
            <% } else{%>
            <table style="width: 100%;">
                <tr>
                    <th>columns</th>
                    <% list.categorical.forEach(function(col) { %>
                    <th><%= col %></th>
                    <% });  %>
                </tr>
                <tr>
                    <th>unique</th>
                    <% list.unique.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>top</th>
                    <% list.top.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
                <tr>
                    <th>frequency</th>
                    <% list.freq.forEach(function (dt) { %>
                    <td><%= dt %> </td>
                    <% }); %>
                </tr>
            </table>
            <%}%>
        
                <% } %>
        </div>
    </div>



    <!--Categorical Labelling Modal -->
    <div class="modal fade" id="categorical_labelling" tabindex="-1" role="dialog"
        aria-labelledby="categorical_labelling" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="">Categorical Labelling Modal</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="catLabels" method="POST" action="/categorical_labelling">
                        <h1>Encoding Labels</h1>
                        <% list.categorical.forEach(function(column){%>
                        <input type="radio" id='<%=column%>' name="encodingLabel"
                            value='<%=column%>'><%=column%></input>
                        <%})%>
                        <br>
                        <h1>One Hot Encoding</h1>
                        <% list.categorical.forEach(function(column){%>
                        <input type="radio" id='<%=column%>' name="oneHotEncoding"
                            value='<%=column%>'><%=column%></input>
                        <%})%>
                        <br>
                        <h1>Binary Encoding</h1>
                        <% list.categorical.forEach(function(column){%>
                        <input type="radio" id='<%=column%>' name="binaryEncoding"
                            value='<%=column%>'><%=column%></input>
                        <%})%>
                        <br>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>






    <!--Correlation Matrix Modal -->
    <div class="modal fade" id="correlation_matrix" tabindex="-1" role="dialog" aria-labelledby="correlation_matrix"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="">Correlation Matrix Modal</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="corrMat">
                        <h1>Correlation Matrix</h1>
                        <% list.numerical.forEach(function(column){%>
                        <input type="checkbox" id='<%=column%>' name="column" value='<%=column%>'><%=column%></input>
                        <%})%>
                        <button type="submit" onclick="corrSub(event)">Submit</button>
                        <br>
                    </form>

                    <div class="main">
                        <div id="myDiv" style="width:800px;height:400px;"></div>
                    </div>

                </div>

            </div>
        </div>
    </div>



</body>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.11/jquery.csv.min.js"
    integrity="sha512-Y8iWYJDo6HiTo5xtml1g4QqHtl/PO1w+dmUpQfQSOTqKNsMhExfyPN2ncNAe9JuJUSKzwK/b6oaNPop4MXzkwg=="
    crossorigin="anonymous">
</script>
<script script>
    $('#catLabels input[type=radio]').change(function () {
        // When any radio button on the page is selected,
        // then deselect all other radio buttons.
        $('#catLabels input[type=radio]:checked').not(this).prop('checked', false);
    });


    function corrSub(event) {
        event.preventDefault();
        console.log("here");
        var column = [];
        $('#corrMat input[type=checkbox]:checked').each(function (col) {
            column.push($(this).val());
        });
        console.log(column);

        $.ajax({
            url: '/corr_matrix',
            type: 'post',
            data: {
                column: column,
            },
            success: function (response) {
                var data = [{
                    z: response.reverse(),
                    x: column,
                    y: column.slice().reverse(),
                    type: 'heatmap'
                }];

                Plotly.newPlot('myDiv', data);
            }
        });

    }
</script>

</html>